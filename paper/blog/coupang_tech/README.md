# 쿠팡 기술블로그

### Contents

* AI/ML 시스템 구축에 대한 가이드
* ...

<br>



## AI/ML 시스템 구축에 대한 가이드


### 두 종류의 상이한 AI 시스템

* 산업계(기업)
   * 지식 기반 접근 방식
      * 휴리스틱(heuristics)이 결합된 온갖 종류의 사전을 사용.
      * 확률 및 통계, 선형대수 등에 대한 전문지식은 많이 필요없음.
* 학술계
   * 모델 구축 방식에 집중.
   * 지식과 모델을 모두 사용한 알고리즘을 꺼림. 
   * 지식을 사용한 알고리즘 구현이 모델의 비범성(remarkability)를 저하는 것처럼 보이기 때문. 
   * 이로 인해 가장 진화된 알고리즘은 모델만 사용한다는 잘못된 인상을 줄 수 있음. 


* 실제로 프로덕트 레벨의 AI/ML 시스템을 구축하기 위해서는 지식과 모델을 모두 포함시켜야 함. 
* 지식이나 모델 가운데 하나만을 기반으로 한 시스템은 고유한 약점이 있음.
* 두 방법을 적절히 조합했을 때 나오는 시너지 효과를 AL/ML 시스템의 성능의 개선으로 이어짐.

#### 지식..? 모델..?

* 지식
   * '언어를 사용해 기술하는 무언가'
   * 예를 들어, 브랜드명 목록, 로고의 이름 등
   * 즉, 지식이란 데이터에 부여할 수 있는 모든 종류의 레이블(label)
* 모델
   * 주어진 데이터와 해당 데이터의 레이블(지식)을 매핑하는 기능적 매핑(functional mapping)을 뜻함.
   * 모든 parametric/non-parametric 알고리즘은 모든 종류의 변형과 전환을 통해 기대할 수 있는 결과값과 입력값 사이의 매핑임.

#### 순수 '지식' 기반 AI 시스템의 단점

* 지식 기반 시스템은 인간의 지식에 의존. 인간의 지식은 포괄적이면서 정확히 설명하기 쉽지 않음.
* 어느 분야든 지식의 양은 방대함. 인간이 직접 모든 지식을 소화하기란 어려움. 즉, 시스템을 확장하기 어려움.
* 지식은 시의성이 높음. 새로운 발견 또는 기술의 진화에 따라 무용지물이 될 수 있음. 이러한 특징을 가지는 지식 베이스를 일일이 업데이트하기란 쉽지 않음.
* 지식은 상황에 따라 달라짐. 일종의 중의성이 있음. 어떤 지식의 유효성을 위해 (복잡한) 조건을 직접 일일이 명시해야 함. 하지만, 모델은 이러한 상관관계를 손쉽게 식별할 수 있음.

#### 순수 '모델' 기반 AI 시스템의 단점

* 통계 혹은 딥러닝 모델은 대다수의 데이터에 대해 적정 적합(generalized fitting)을 찾기 위해 항상 시도함. 이에 필연적으로 대다수와 멀리 위치한 소수의 데이터는 놓치게 됨.
* 논리적 추론은 통계 혹은 딥러닝 모델로 완성하기 매우 어렵다. 반면, 지식 기반 시스템은 아주 쉽다. 모델의 본능적 반응을 제외하고, 인간이 결정을 내릴 때는 일련의 논리적 추론(logical reasoning) 과정이 필요.


### 지식-모델-시너지 AI 시스템

#### 이상적인 AI 시스템 조건

* 개방형 세계(open world)에 대한 가정
   * 시스템은 학습 데이터에서 이미 발견한 문제를 처리하는 것뿐만 아니라 새로운 지식도 발견할 수 있어야 함.
* 자가 개선(self-improvable)
   * 100% 자가 개선은 없다. 하지만, 정적인 시스템과 대조를 이뤄야 함. 업데이트된 지식을 모델이 평가하고 재학습 메커니즘을 갖춰야 함. 학습 데이터 축적 메커니즘도 필요.
* 통제가능성(Dictatability)
   * 시스템이 운영자로 하여금 특정 인풋에 대한 아웃풋을 제어할 수 있도록 허용해야 함.

#### 지식-모델-상승효과 AI 시스템을 구축하는 방법

* 데이터 수집 모듈
* 지식 레이블링 모듈
* 모델 학습 및 평가 모듈

* 모델은 가능한 많은 지식을 사용해야 함.
* 모델은 지식을 발견할 수 있어야 함.
   * 프로덕션에서의 대부분 문제들이 개방형 세계 가정을 하므로 모델은 주어진 지식 세트에 대해 매핑을 하면서, 동시에 주어진 세트 이외의 지식을 예측해야 함. 모델이 이러한 역량을 갖추려면 '특수한 설계'가 필요함. (아래 내용은 기계학습 이론에 입각.)
      * (a) Property를 활용하여 Class를 대체
         * 상품명과 브랜드명 사이의 매핑을 찾는 방식으로 문제를 모델링하기 보다는 상품명을 브랜드명으로 분류하는 방식을 사용.
         * 특정 브랜드명에서 일반화된 브랜드명 클래스(class)로의 변경을 통해 신규 브랜드명을 발견할 수 있는 모델 역량이 개선됨.
      * (b) 폐쇄형 집합 분류(close set classification) 문제를 개방형 집합 근방 (open set neighborhood) 문제로 전환
         * 폐쇄형 세계 솔루션은 상품명으로부터 주어진 브랜드명의 집합을 예측하도록 분류기를 학습하는 것.
         * 개방형 집합 예측 솔루션은 상품명에서 (여러 개의) 임베딩을 도출한 후에 전체 브랜드명 임베딩과 유사성을 비교하는 것이다. 충분히 유사할 경우에는 이미 알고있는 브랜드명일 확률이 크다.
      * (c) 원샷 러닝(one-shot learning) 활용
         * 전체 학습 세트에서 하나의 세트를 무작위로 선정하여 해당 세트를 기반으로 모델을 학습시키는 방식.
         * 이때 모델은 매핑을 기억하는 것이 아니라 무작위로 주어진 학습 세트에서 스스로 분류하는 방법을 찾도록 학습됨.
* 모델의 적합성(adequacy) 모니터링
   * 모델의 성능을 측정할 수 있는 지표가 있어야 함. 모니터링 지표를 통해 새로운 학습 반복(iteration)을 실시한다.
   * 지식에 대한 유효성을 모니터링하는 메커니즘도 필요. (ex. 지속적으로 지식에 대한 사용량을 데이터로 모니터링)
* 모델 내 지식의 표현(representation)
   * 지식을 모델에 아웃풋으로 표현하는 경우 (즉, 학습 데이터로 사용할 경우), 예상되는 아웃풋을 생성하도록 모델을 학습시킴으로서 지식이 모델에 내재된다.
   * 지식은 모델의 인풋으로도 사용됨. 딥러닝에서 멀티테스킹 방식으로 모델을 연결하고 end-to-end로 모델을 학습시킬 수 있음. (ex. 상품 중복 제거를 위한 딥러닝 아키텍쳐).


